<!doctype html>
<html lang="en">
  <head>
	  <meta charset="UTF-8">
  	<title>Project2</title>
	  <link rel="stylesheet" href="css/main.css">
  </head>
  <body onload="init()">
	  <div class="banner">
			<p>Title</p>
		</div>

		<div class="body_container">
			<div class="body_container_left_col">

        <div class="body_container_left_col_row_1">
          <p>Relative</p>
          <form onsubmit="return relative_send()" method="post" name="relative">
            X: <input type="text" name="x"><br>
            Y: <input type="text" name="y"><br>
            &nbsp&nbsp&nbsp<input type="submit" value="update">
          </form>
        </div>

        <div class="body_container_left_col_row_2">
          <p>Absolute</p>
        </div>

        <div class="body_container_left_col_row_3">
          <button class="log_button" type="button" onclick="get_log()">.log</button>
        </div>
			</div>
			<div class="body_container_right_col">
        <p id="current_display"></p>
		  </div>
		</div>

		<footer class="footer">
       <p>CS1980 Capstone <a href="https://cs.pitt.edu/">University of Pittsburgh</a></p>
    </footer>

    <script>

    //http://jsfiddle.net/CYMtV/
    //axii display ^^

      var socket;
      var x_current;
      var y_current;

      //Initial Conditions
      function init() {
        // handle initial axii conditions
        socket = new WebSocket("ws://localhost:9001")
        x_current = 0;
        y_current = 0;
        initial_string = "X: " + x_current + "\tY: " + y_current;
        document.getElementById("current_display").innerHTML = initial_string;
      }

      //Send Updates
      function relative_send() {
        // get xy from Relative form
        var x = document.forms["relative"]["x"].value;
        var y = document.forms["relative"]["y"].value;
        // error check
        if(isNaN(x) || isNaN(y)) {
          alert("Invalid Relative Changes");
          return false;
        }
        // structure json object
        var xy_update = '{ "coordinates" : [' +
        '{"x":' + x + ', "y":' + y + '}' +
        ']}';
        // send object
        socket.send(xy_update);
      }

      //Send Updates
      function absolute_send() {
        // Absolute div tag, parallel the relative div

      }

      //Get Log
      function get_log() {
        // retreive log from server

      }

      //--Socket-Methods--
      //Initial Connection
      socket.onopen = function (event) {
        // acknowledge its been opened

      }

      //Get Updates
      socket.onmessage = function (event) {
        // receive updates
        var xy = JSON.parse(event.data);
        // parse x,y
        x_current = xy.coordinates[1].x;
        y_current = xy.coordinates[1].y;
        // update string display
        initial_string = "X: " + x_current + "\tY: " + y_current;
        document.getElementById("current_display").innerHTML = initial_string;
      }

    </script>
  </body>
</html>
